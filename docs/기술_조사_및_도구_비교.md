# gendocs 기술 조사 및 도구 비교

> **작성일**: 2026-02-12
> **목적**: gendocs 프로젝트의 기술 스택 선정 근거, 외부 도구 조사 결과, 향후 확장 방향을 한 곳에 정리

---

## 1. 조사 배경

gendocs는 마크다운(MD)을 원본으로 비즈니스 문서(DOCX, XLSX, PPTX, PDF 등)를 자동 생성하는 Claude Code 전용 툴킷이다. 프로젝트 구축 과정에서 다음 질문이 제기되었다:

- 생성한 문서를 Claude Code가 자체 검증할 수 있는가?
- MCP(Model Context Protocol) 서버 중 Office 문서 관련 검증된 도구가 있는가?
- Anthropic 공식 도구(`anthropics/skills`)와 비교했을 때 gendocs의 위치는?

---

## 2. MCP 서버 조사 결과

### 2.1 검증된 도구 (Stars 1,000+)

| 서버 | Stars | 용도 | 포맷 | 최근 업데이트 |
|------|------:|------|------|-------------|
| **markdownify-mcp** (zcaceres) | 2,406 | Office → Markdown 변환 (읽기 전용) | DOCX, XLSX, PPTX, PDF | 2026-02-11 |
| **Office-Word-MCP-Server** (GongRzhe) | 1,569 | Word 읽기+쓰기+편집 (30+개 도구) | DOCX, PDF | 2025-12-31 |

### 2.2 활발하지만 소규모

| 서버 | Stars | 용도 | 포맷 | 최근 업데이트 |
|------|------:|------|------|-------------|
| **mcp-ms-office-documents** (dvejsada) | 11 | Office 문서 생성 (Docker) | DOCX, XLSX, PPTX, EML | 2026-02-08 |

### 2.3 방치 또는 미검증 (Stars 50 미만, 업데이트 3개월+)

| 서버 | Stars | 상태 |
|------|------:|------|
| famano/mcp-server-office | 32 | 9개월 방치 |
| jenstangen1/pptx-xlsx-mcp | 26 | 10개월 방치 |
| Duds/md-converter | 6 | 3개월 방치 |

### 2.4 공식 MCP 레퍼런스 서버 (Anthropic/MCP 운영위)

`modelcontextprotocol/servers` (78,489 stars)에서 관리하는 공식 서버 7개:

| 서버 | 용도 |
|------|------|
| Everything | 테스트/레퍼런스 |
| Fetch | 웹 콘텐츠 수집 |
| Filesystem | 파일 시스템 접근 |
| Git | Git 저장소 조작 |
| Memory | 지식 그래프 기반 영속 메모리 |
| Sequential Thinking | 단계적 문제 해결 |
| Time | 시간/시간대 변환 |

> **결론**: 공식 MCP 레퍼런스 서버에 문서 생성/편집 관련 도구는 없다.

---

## 3. Anthropic 공식 도구 분석

### 3.1 `anthropics/skills` (68,209 stars)

Claude.ai의 파일 생성 기능을 구동하는 공식 스킬 모음. **라이브러리가 아니라 "Claude 지시서(SKILL.md) + 유틸리티 스크립트"** 구조.

#### 스킬 구성

| 스킬 | 생성 기술 | 편집 기술 | 검증 방식 |
|------|----------|----------|----------|
| **DOCX** | `docx` (npm) | ZIP → XML 직접 편집 → 재압축 | XSD 스키마 검증 + 자동수리 (`validate.py`) |
| **XLSX** | `openpyxl` (Python) | openpyxl API | LibreOffice 수식 재계산 (`recalc.py`) |
| **PPTX** | `pptxgenjs` (npm) | ZIP → XML 직접 편집 → 재압축 | PDF 변환 → 이미지 → 시각 검증 |
| **PDF** | `reportlab` (Python) | `pypdf` / `pdf-lib` | 폼 필드 좌표 검증 |

#### 내부 동작 방식

```
[DOCX 생성]
Claude가 SKILL.md 읽음 → docx npm으로 JS 코드 작성·실행 → .docx 파일 생성 → validate.py로 검증

[DOCX 편집 (기존 문서 수정)]
unpack.py로 ZIP 해체 → word/*.xml 직접 편집 → pack.py로 재압축 + XSD 검증

[PPTX QA 루프]
생성 → LibreOffice로 PDF 변환 → pdftoppm으로 이미지 변환 → 시각 확인 → 수정 → 재생성
```

#### 공용 유틸리티 (`scripts/office/`)

| 스크립트 | 역할 | DOCX | XLSX | PPTX |
|---------|------|:----:|:----:|:----:|
| `unpack.py` | ZIP 해체, XML 정렬, 인접 Run 병합 | O | - | O |
| `pack.py` | XML 압축, XSD 검증, DOCX/PPTX 재생성 | O | - | O |
| `validate.py` | XSD 스키마 검증 + 자동수리 | O | - | O |
| `soffice.py` | LibreOffice 래퍼 (샌드박스 대응) | O | O | O |

#### 주요 교훈 (SKILL.md에서 발견된 주의사항)

**DOCX:**
- `WidthType.PERCENTAGE`는 Google Docs에서 깨짐 → DXA 단위만 사용
- 목차(TOC)는 반드시 `HeadingLevel` 사용 (커스텀 스타일 불가)
- Landscape 모드에서 portrait 치수를 넘겨야 함 (docx-js가 내부 스왑)

**PPTX:**
- hex 색상에 `#` 붙이면 파일 손상
- 8자리 hex(투명도 포함)도 파일 손상 → `opacity` 속성 사용
- option 객체 재사용 금지 (pptxgenjs가 내부 변형)

**XLSX:**
- `data_only=True`로 열고 저장하면 수식 영구 파괴
- 수식 재계산은 반드시 LibreOffice 경유

### 3.2 `anthropics/knowledge-work-plugins` (7,098 stars)

2026년 1월 출시. Claude Cowork용 Microsoft 365 연동 플러그인 모음. 법무, 재무, 마케팅 등 도메인별 워크플로우 자동화.

---

## 4. gendocs vs anthropics/skills 비교

### 4.1 DOCX 생성 비교

| 항목 | gendocs | anthropics/skills |
|------|---------|-------------------|
| **생성 패키지** | `docx` (npm) | `docx` (npm) — 동일 |
| **접근 방식** | 전용 템플릿(professional.js)이 스타일·레이아웃 캡슐화 | SKILL.md 지시문에 규칙 나열, 매번 코드 생성 |
| **스타일 제어** | 템플릿에 디자인 토큰 고정 (색상, 폰트, 크기 일체) | Claude가 매번 판단 |
| **테이블 너비** | 헤더 패턴 매칭으로 자동 결정 (문서 유형별 최적화) | Claude가 매번 계산 |
| **코드 블록** | 다크테마(VS Code 스타일) 구문 강조 내장 | 기본 코드 블록 |
| **표지** | 로고+메타정보+스타일 통일된 표지 API | Claude가 매번 구성 |
| **머릿글/바닥글** | 문서 제목+버전+페이지 번호 자동 | Claude가 매번 구성 |
| **일관성** | 템플릿이 보장 (같은 API 호출 = 같은 결과) | Claude 판단에 의존 (세션마다 다를 수 있음) |
| **검증** | 없음 | XSD 스키마 검증 + 자동수리 |
| **기존 문서 편집** | 미지원 (새로 생성만) | unpack/edit/repack으로 XML 편집 |

### 4.2 핵심 차이점

**gendocs의 강점: 커스터마이징과 일관성**

anthropics/skills는 범용 도구다. 어떤 DOCX든 만들 수 있지만, 매번 Claude가 스타일을 처음부터 판단한다. 결과물의 디자인이 세션마다 달라질 수 있다.

gendocs는 전용 목적 도구다. `professional.js` 템플릿이 디자인 토큰(색상, 폰트, 간격, 테이블 스타일)을 고정하고, 변환 스크립트는 이 API만 호출한다. **같은 입력이면 항상 같은 결과**가 나온다.

| 관점 | gendocs | anthropics/skills |
|------|---------|-------------------|
| 디자인 일관성 | 템플릿이 강제 | Claude 재량 |
| 커스터마이징 깊이 | 테이블 너비, 코드 블록 테마, 표지 등 세밀 제어 | 범용적 (세밀 제어는 매번 지시 필요) |
| 재현성 | 스크립트 재실행 = 동일 결과 | 동일 결과 보장 안 됨 |
| 학습 곡선 | examples/ 참조로 패턴 학습 | SKILL.md 전체를 매번 참조 |

**anthropics/skills의 강점: 검증과 편집**

gendocs에 없고 skills에 있는 것:
- XSD 스키마 검증 (생성된 DOCX가 규격에 맞는지 자동 확인)
- 자동수리 (durableId 오버플로, xml:space 누락 등 자동 교정)
- 기존 문서 편집 (unpack → XML 수정 → repack)

---

## 5. 향후 포맷 확장 기술 스택 (확정)

anthropics/skills가 실전 검증한 기술 스택을 그대로 채택한다.

| 포맷 | 패키지 | 언어 | 비고 |
|------|--------|------|------|
| **DOCX** | `docx` | Node.js | 이미 사용 중 (검증 완료) |
| **XLSX** | `openpyxl` | Python | Anthropic 선택. 수식 재계산은 LibreOffice 필요 |
| **PPTX** | `pptxgenjs` | Node.js | Anthropic 선택. 디자인 가이드 참조 가치 높음 |
| **PDF** | `reportlab` | Python | Anthropic 선택. Canvas + Platypus 이중 API |

### package.json 확장 (예정)

```json
{
  "dependencies": {
    "docx": "^9.1.1",
    "pptxgenjs": "^4.0.0"
  }
}
```

### requirements.txt 확장 (예정)

```
matplotlib>=3.7
openpyxl>=3.1
reportlab>=4.0
```

---

## 6. 검증 체계 도입 방안

### 6.1 현재 상태 (검증 없음)

```
MD → 변환 스크립트 실행 → DOCX 생성 → (사용자가 열어서 직접 확인)
```

### 6.2 목표 상태 (자동 검증 포함)

```
MD → 변환 스크립트 실행 → DOCX 생성
                              ↓
                    구조 검증 (자동)
                    ├─ XSD 스키마 검증
                    ├─ 섹션/페이지 구조 리포트
                    └─ 요소 카운트 (테이블, 이미지, 코드블록 등)
                              ↓
                    문제 있으면 스크립트 수정 → 재생성
```

### 6.3 도입 우선순위

| 단계 | 검증 방식 | 도구 | 난이도 |
|------|----------|------|--------|
| **1단계** | 생성 시 구조 리포트 출력 | 변환 스크립트 내장 (추가 의존성 없음) | 낮음 |
| **2단계** | DOCX 역파싱으로 내용 검증 | markdownify-mcp 또는 자체 스크립트 | 중간 |
| **3단계** | XSD 스키마 검증 | anthropics/skills의 validate.py 참조 | 중간 |
| **4단계** | 시각적 검증 (PDF→이미지) | LibreOffice + pdftoppm | 높음 (외부 의존성) |

---

## 7. 결론

### gendocs의 DOCX 생성은 anthropics/skills보다 커스터마이징에서 더 정확하다

- 동일한 `docx` npm 패키지를 사용하지만, gendocs는 **전용 템플릿 계층**이 있다
- 디자인 토큰(색상, 폰트, 간격)이 템플릿에 고정되어 **일관된 결과를 보장**한다
- 테이블 너비 자동 계산, 다크테마 코드 블록, 표지/머릿글/바닥글 등 **반복 사용되는 요소가 API로 캡슐화**되어 있다
- anthropics/skills는 범용이라 매번 Claude가 스타일을 새로 판단하지만, gendocs는 한 번 정의한 스타일을 재사용한다

### 검증 체계만 추가되면 한층 더 완전해진다

- 현재 유일한 약점은 **생성 후 자동 검증이 없다**는 것이다
- anthropics/skills의 `validate.py`(XSD 스키마 검증)와 구조 리포트를 참조하여 검증 루프를 추가하면, **생성 품질과 검증 품질 모두를 갖춘 도구**가 된다
- 검증은 단계적으로 도입한다 (구조 리포트 → 역파싱 → XSD → 시각적 검증)
